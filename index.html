<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Escape Game Technologie - Tournoi Brevet</title>
    
    <!-- Chargement des bibliothÃ¨ques via CDN -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        'orbitron': ['Orbitron', 'sans-serif'],
                        'rajdhani': ['Rajdhani', 'sans-serif']
                    },
                    animation: {
                        'pulse-slow': 'pulse 3s infinite',
                        'bounce-slow': 'bounce 2s infinite'
                    }
                }
            }
        }
    </script>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Lucide Icons (alternative) -->
    <link href="https://cdn.jsdelivr.net/npm/lucide-static@latest/font/lucide.css" rel="stylesheet">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Rajdhani', sans-serif;
            background-color: #0f172a;
            color: #e2e8f0;
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        .font-orbitron {
            font-family: 'Orbitron', sans-serif;
        }
        
        .glass-panel {
            background: rgba(30, 41, 59, 0.7);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .neon-border {
            box-shadow: 0 0 15px rgba(59, 130, 246, 0.5);
            border: 1px solid rgba(59, 130, 246, 0.5);
        }
        
        .neon-text {
            text-shadow: 0 0 10px rgba(59, 130, 246, 0.8);
        }
        
        .text-gradient {
            background: linear-gradient(90deg, #3b82f6, #8b5cf6, #ec4899);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .scrollbar-thin::-webkit-scrollbar {
            width: 6px;
        }
        
        .scrollbar-thin::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
        }
        
        .scrollbar-thin::-webkit-scrollbar-thumb {
            background: rgba(59, 130, 246, 0.5);
            border-radius: 10px;
        }
        
        .scrollbar-thin::-webkit-scrollbar-thumb:hover {
            background: rgba(59, 130, 246, 0.8);
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        
        .animate-float {
            animation: float 3s ease-in-out infinite;
        }
        
        @keyframes glow {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        .animate-glow {
            animation: glow 2s ease-in-out infinite;
        }
        
        /* Styles pour les icÃ´nes Lucide */
        .lucide {
            width: 24px;
            height: 24px;
            stroke-width: 1.5;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .text-6xl { font-size: 3rem; }
            .text-5xl { font-size: 2.5rem; }
            .text-4xl { font-size: 2rem; }
            .text-3xl { font-size: 1.75rem; }
            .p-8 { padding: 1.5rem; }
            .grid-cols-2 { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        // ==================== COMPOSANTS ICÃ”NES SIMPLIFIÃ‰S ====================
        const Icon = ({ name, className = "", size = 24 }) => {
            const icons = {
                clock: 'ðŸ•’',
                lightbulb: 'ðŸ’¡',
                lock: 'ðŸ”’',
                check: 'âœ…',
                x: 'âŒ',
                key: 'ðŸ”‘',
                trophy: 'ðŸ†',
                book: 'ðŸ“š',
                users: 'ðŸ‘¥',
                chart: 'ðŸ“Š',
                download: 'ðŸ“¥',
                share: 'ðŸ”—',
                qr: 'ðŸ”³',
                star: 'â­',
                crown: 'ðŸ‘‘',
                medal: 'ðŸ…',
                home: 'ðŸ ',
                play: 'â–¶ï¸',
                settings: 'âš™ï¸',
                arrowLeft: 'â¬…ï¸',
                skull: 'ðŸ’€',
                terminal: 'ðŸ’»',
                shield: 'ðŸ›¡ï¸',
                microscope: 'ðŸ”¬',
                anvil: 'âš’ï¸',
                zap: 'âš¡',
                cpu: 'ðŸ’¾',
                binary: 'ðŸ”¢'
            };
            
            return React.createElement('span', {
                className: `inline-block ${className}`,
                style: { fontSize: `${size}px` }
            }, icons[name] || 'â“');
        };
        
        // ==================== APPLICATION PRINCIPALE ====================
        const { useState, useEffect, useMemo } = React;
        
        function EscapeGame() {
            const TEMPS_PAR_ROOM = 600;
            
            const [ecran, setEcran] = useState('accueil');
            const [roomActuelle, setRoomActuelle] = useState(0);
            const [temps, setTemps] = useState(TEMPS_PAR_ROOM);
            const [enigmeActuelle, setEnigmeActuelle] = useState(0);
            const [enigmesSelectionnees, setEnigmesSelectionnees] = useState([]);
            const [reponse, setReponse] = useState('');
            const [erreur, setErreur] = useState(false);
            const [enigmesResolues, setEnigmesResolues] = useState([false, false, false, false]);
            const [indiceAffiche, setIndiceAffiche] = useState(false);
            const [codesRooms, setCodesRooms] = useState([]);
            const [codeEntree, setCodeEntree] = useState('');
            const [erreurCode, setErreurCode] = useState(false);
            const [messageDecrypte, setMessageDecrypte] = useState('');
            const [tempsTotal, setTempsTotal] = useState(0);
            const [chiffrementSelectionne, setChiffrementSelectionne] = useState(null);
            
            // ==================== Ã‰TAT DU TOURNOI ====================
            const [tournoiNom, setTournoiNom] = useState('');
            const [tournoiClasse, setTournoiClasse] = useState('');
            const [scoreEnregistre, setScoreEnregistre] = useState(false);
            const [classement, setClassement] = useState([]);
            const [modeAdmin, setModeAdmin] = useState(false);
            const [lockoutTime, setLockoutTime] = useState(null);
            const [importCode, setImportCode] = useState('');
            
            // ==================== BANQUE D'Ã‰NIGMES ====================
            const banqueEnigmes = {
                evolution: [
                    { question: "Quelle innovation a permis de passer du tÃ©lÃ©phone fixe au mobile ?", reponse: "portabilite", indice: "Ce qui permet de dÃ©placer", type: "text" },
                    { question: "En quelle annÃ©e le premier iPhone est-il sorti ?", reponse: "2007", indice: "Entre 2000 et 2010", type: "number" },
                    { question: "Comment appelle-t-on une innovation qui change radicalement un marchÃ© ?", reponse: "rupture", indice: "Innovation de...", type: "text" },
                    { question: "Quelle est la famille de matÃ©riaux la plus lÃ©gÃ¨re ?", reponse: "plastique", indice: "DÃ©rivÃ© du pÃ©trole", type: "text" },
                    { question: "Quel matÃ©riau est issu d'un arbre ?", reponse: "bois", indice: "MatÃ©riau naturel", type: "text" },
                    { question: "Comment appelle-t-on le mÃ©lange de fer et de carbone ?", reponse: "acier", indice: "Alliage mÃ©tallique", type: "text" },
                    { question: "Combien y a-t-il de grandes familles de matÃ©riaux ?", reponse: "4", indice: "MÃ©taux, plastiques...", type: "number" },
                    { question: "Quel matÃ©riau conduit le mieux l'Ã©lectricitÃ© ?", reponse: "cuivre", indice: "MÃ©tal orangÃ©", type: "text" },
                    { question: "Quel matÃ©riau est recyclable Ã  l'infini ?", reponse: "aluminium", indice: "MÃ©tal lÃ©ger", type: "text" },
                    { question: "Comment s'appelle l'Ã©volution qui prend en compte l'environnement ?", reponse: "durable", indice: "DÃ©veloppement...", type: "text" },
                    { question: "Quel objet a remplacÃ© le walkman ?", reponse: "smartphone", indice: "TÃ©lÃ©phone intelligent", type: "text" },
                    { question: "Combien de gÃ©nÃ©rations de tÃ©lÃ©phones mobiles existe-t-il ?", reponse: "5", indice: "On parle de 5G", type: "number" },
                    { question: "Quel matÃ©riau est transparent et cassant ?", reponse: "verre", indice: "Pour les fenÃªtres", type: "text" },
                    { question: "Quel mÃ©tal ne rouille pas ?", reponse: "inox", indice: "Acier inoxydable", type: "text" },
                    { question: "Comment appelle-t-on un objet qui se connecte Ã  Internet ?", reponse: "connecte", indice: "Objet...", type: "text" }
                ],
                cybersecurite: [
                    { question: "Comment appelle-t-on un programme malveillant ?", reponse: "virus", indice: "Comme une maladie", type: "text" },
                    { question: "Combien de caractÃ¨res min pour un mot de passe sÃ»r ?", reponse: "12", indice: "Plus de 10", type: "number" },
                    { question: "Comment s'appelle l'usurpation d'identitÃ© par email ?", reponse: "phishing", indice: "Commence par 'ph'", type: "text" },
                    { question: "Quelle technique crypte un fichier ?", reponse: "chiffrement", indice: "Rendre illisible", type: "text" },
                    { question: "Comment appelle-t-on les traces sur Internet ?", reponse: "numeriques", indice: "Traces...", type: "text" },
                    { question: "Quel protocole sÃ©curise les sites web ?", reponse: "https", indice: "HTTP + S", type: "text" },
                    { question: "Combien d'octets dans 1 kilooctet ?", reponse: "1024", indice: "Un peu plus de 1000", type: "number" },
                    { question: "Quelle loi protÃ¨ge les donnÃ©es en Europe ?", reponse: "rgpd", indice: "4 lettres", type: "text" },
                    { question: "Comment appelle-t-on l'authentification en deux Ã©tapes ?", reponse: "double", indice: "Authentification...", type: "text" },
                    { question: "Que signifie CPU ?", reponse: "processeur", indice: "Cerveau de l'ordinateur", type: "text" },
                    { question: "Combien de bits dans un octet ?", reponse: "8", indice: "Moins de 10", type: "number" },
                    { question: "Comment s'appelle la mÃ©moire temporaire ?", reponse: "ram", indice: "3 lettres", type: "text" },
                    { question: "Quel langage utilise des blocs visuels ?", reponse: "scratch", indice: "Pour dÃ©butants", type: "text" },
                    { question: "Comment s'appelle l'adresse d'un site web ?", reponse: "url", indice: "3 lettres", type: "text" },
                    { question: "Combien de valeurs pour un bit ?", reponse: "2", indice: "0 et 1", type: "number" }
                ],
                durable: [
                    { question: "Combien de piliers du dÃ©veloppement durable ?", reponse: "3", indice: "Ã‰conomique, social...", type: "number" },
                    { question: "Sur combien est notÃ© l'indice de rÃ©parabilitÃ© ?", reponse: "10", indice: "Comme une note", type: "number" },
                    { question: "Quel mÃ©tal prÃ©cieux dans les smartphones ?", reponse: "or", indice: "MÃ©tal jaune", type: "text" },
                    { question: "Quelle Ã©nergie provient du soleil ?", reponse: "solaire", indice: "Ã‰nergie...", type: "text" },
                    { question: "Comment s'appelle l'Ã©nergie du vent ?", reponse: "eolienne", indice: "Ã‰nergie...", type: "text" },
                    { question: "Combien d'Ã©nergies renouvelables principales ?", reponse: "5", indice: "Solaire, Ã©olien...", type: "number" },
                    { question: "Quelle Ã©nergie utilise la force de l'eau ?", reponse: "hydraulique", indice: "Barrages", type: "text" },
                    { question: "Comment s'appelle l'Ã©nergie de la Terre ?", reponse: "geothermique", indice: "GÃ©o = Terre", type: "text" },
                    { question: "Combien de litres d'eau pour fabriquer un jean ?", reponse: "7500", indice: "Entre 7000 et 8000", type: "number" },
                    { question: "Comment s'appelle le cycle de vie d'un produit ?", reponse: "berceau", indice: "Du... au tombeau", type: "text" },
                    { question: "Quel gaz Ã  effet de serre principal ?", reponse: "co2", indice: "Formule chimique", type: "text" },
                    { question: "Combien d'annÃ©es pour dÃ©grader une bouteille plastique ?", reponse: "450", indice: "Entre 400 et 500", type: "number" },
                    { question: "Comment appelle-t-on l'Ã©nergie qui se renouvelle ?", reponse: "renouvelable", indice: "Ã‰nergie...", type: "text" },
                    { question: "Quel label garantit une production Ã©cologique ?", reponse: "ecolabel", indice: "Ã‰co + label", type: "text" },
                    { question: "Combien de Watts consomme une ampoule LED ?", reponse: "10", indice: "Moins de 15W", type: "number" }
                ],
                utilisateur: [
                    { question: "Comment s'appelle l'Ã©tude de l'adaptation Ã  l'humain ?", reponse: "ergonomie", indice: "Science du confort", type: "text" },
                    { question: "Combien de clics max pour accÃ©der Ã  une info ?", reponse: "3", indice: "RÃ¨gle des ... clics", type: "number" },
                    { question: "Comment s'appelle le document qui liste les exigences ?", reponse: "cahier", indice: "... des charges", type: "text" },
                    { question: "Quelle couleur pour les boutons de validation ?", reponse: "vert", indice: "Feu pour avancer", type: "text" },
                    { question: "Quelle fonction permet de ralentir un vÃ©lo ?", reponse: "freiner", indice: "Fonction de...", type: "text" },
                    { question: "Comment s'appelle la fonction qui guide ?", reponse: "diriger", indice: "Volant, guidon", type: "text" },
                    { question: "Quelle fonction permet de voir la nuit ?", reponse: "eclairer", indice: "Phares", type: "text" },
                    { question: "Combien de fonctions dans un vÃ©lo ?", reponse: "5", indice: "Propulser, diriger...", type: "number" },
                    { question: "Comment s'appelle le systÃ¨me de transmission ?", reponse: "transmission", indice: "ChaÃ®ne, engrenages", type: "text" },
                    { question: "Comment s'appelle le mouvement circulaire ?", reponse: "rotation", indice: "Tourner", type: "text" },
                    { question: "Comment s'appelle une instruction qui se rÃ©pÃ¨te ?", reponse: "boucle", indice: "For, while", type: "text" },
                    { question: "Quelle structure fait un choix ?", reponse: "si", indice: "Instruction if", type: "text" },
                    { question: "Comment s'appelle une suite d'instructions ?", reponse: "algorithme", indice: "MÃ©thode", type: "text" },
                    { question: "Combien de valeurs pour une variable boolÃ©enne ?", reponse: "2", indice: "Vrai ou faux", type: "number" },
                    { question: "Comment s'appelle un bloc rÃ©utilisable ?", reponse: "fonction", indice: "Sous-programme", type: "text" }
                ]
            };
            
            const roomsConfig = [
                { nom: "Ã‰volution Technologique", theme: "evolution", couleur: "from-purple-900 via-blue-900", icone: "ðŸ”¬" },
                { nom: "CybersÃ©curitÃ©", theme: "cybersecurite", couleur: "from-red-900 via-orange-900", icone: "ðŸ”" },
                { nom: "DÃ©veloppement Durable", theme: "durable", couleur: "from-green-900 via-emerald-900", icone: "ðŸŒ" },
                { nom: "ExpÃ©rience Utilisateur", theme: "utilisateur", couleur: "from-blue-900 via-cyan-900", icone: "ðŸ‘¤" },
                { nom: "DÃ©cryptage Final", theme: "crypto", couleur: "from-amber-900 via-yellow-900", icone: "ðŸ”‘" }
            ];
            
            const systemesCodeage = [
                {
                    id: 'cesar',
                    nom: 'Chiffre de CÃ©sar',
                    description: 'DÃ©calage de chaque lettre dans l\'alphabet d\'un nombre fixe de positions.',
                    exemple: 'A â†’ D (dÃ©calage +3) ou B â†’ A (dÃ©calage -1)',
                    correct: true
                },
                {
                    id: 'atbash',
                    nom: 'Chiffre Atbash',
                    description: 'Inversion de l\'alphabet : A devient Z, B devient Y, etc.',
                    exemple: 'A â†’ Z, B â†’ Y, C â†’ X',
                    correct: false
                },
                {
                    id: 'morse',
                    nom: 'Code Morse',
                    description: 'Codage en points et traits. Chaque lettre a une combinaison unique.',
                    exemple: 'A = .- , B = -... , S = ...',
                    correct: false
                },
                {
                    id: 'binaire',
                    nom: 'Code Binaire',
                    description: 'Codage en 0 et 1. Chaque lettre correspond Ã  8 bits.',
                    exemple: 'A = 01000001, B = 01000010',
                    correct: false
                }
            ];
            
            // ==================== FONCTIONS TOURNOI ====================
            
            const getClassement = () => {
                try {
                    const stored = localStorage.getItem('escapeGameTournoi');
                    return stored ? JSON.parse(stored) : [];
                } catch {
                    return [];
                }
            };
            
            const sauvegarderScore = () => {
                if (!tournoiNom.trim() || !tournoiClasse.trim()) {
                    alert('Veuillez entrer votre nom et classe pour participer au tournoi !');
                    return false;
                }
                
                // VÃ©rifier le verrouillage
                const lastAttempt = localStorage.getItem('lastAttempt_' + tournoiNom);
                if (lastAttempt) {
                    const diff = Date.now() - parseInt(lastAttempt);
                    if (diff < 3600000) {
                        setLockoutTime(3600000 - diff);
                        alert(`Vous devez attendre ${Math.ceil((3600000 - diff) / 60000)} minutes avant de rejouer pour le tournoi.`);
                        return false;
                    }
                }
                
                const score = {
                    id: Date.now(),
                    nom: tournoiNom,
                    classe: tournoiClasse,
                    temps: formatTemps(tempsTotal),
                    tempsSecondes: tempsTotal,
                    date: new Date().toISOString(),
                    indicesUtilises: enigmesResolues.filter((r, i) => indiceAffiche).length
                };
                
                const classementActuel = getClassement();
                classementActuel.push(score);
                
                // Trier par temps (plus rapide en premier)
                classementActuel.sort((a, b) => a.tempsSecondes - b.tempsSecondes);
                
                // Garder seulement les 100 meilleurs scores
                const top100 = classementActuel.slice(0, 100);
                
                localStorage.setItem('escapeGameTournoi', JSON.stringify(top100));
                localStorage.setItem('lastAttempt_' + tournoiNom, Date.now().toString());
                
                setClassement(top100);
                setScoreEnregistre(true);
                
                // GÃ©nÃ©rer le code de partage
                const code = genererCodePartage();
                alert(`âœ… Score enregistrÃ© !\n\nCode de partage : ${code}\n\nDonnez ce code aux autres postes pour synchroniser les classements !`);
                
                return true;
            };
            
            const genererCodePartage = () => {
                const classementData = getClassement();
                const dataString = JSON.stringify(classementData);
                try {
                    const code = btoa(dataString).substring(0, 30);
                    localStorage.setItem('codePartageTournoi', code);
                    return code;
                } catch {
                    return 'ERROR';
                }
            };
            
            const importerClassement = () => {
                if (!importCode.trim()) {
                    alert('Veuillez entrer un code de partage !');
                    return false;
                }
                
                try {
                    // Nettoyer le code (retirer les espaces)
                    const codeNettoye = importCode.replace(/\s/g, '');
                    const decoded = atob(codeNettoye);
                    const classementImport = JSON.parse(decoded);
                    
                    // Fusionner avec le classement existant
                    const classementActuel = getClassement();
                    const fusion = [...classementActuel, ...classementImport]
                        .filter((score, index, self) => 
                            index === self.findIndex(s => s.id === score.id)
                        )
                        .sort((a, b) => a.tempsSecondes - b.tempsSecondes)
                        .slice(0, 100);
                    
                    localStorage.setItem('escapeGameTournoi', JSON.stringify(fusion));
                    setClassement(fusion);
                    setImportCode('');
                    
                    alert(`âœ… Classement importÃ© avec succÃ¨s !\n${fusion.length} scores au total.`);
                    return true;
                } catch (error) {
                    alert('âŒ Code invalide ! VÃ©rifiez que le code est correct et complet.');
                    return false;
                }
            };
            
            const exporterCSV = () => {
                const classementData = getClassement();
                if (classementData.length === 0) {
                    alert('Aucun score Ã  exporter !');
                    return;
                }
                
                const csvHeader = 'Position,Nom,Classe,Temps,Date\n';
                const csvRows = classementData.map((score, index) => 
                    `${index + 1},"${score.nom.replace(/"/g, '""')}","${score.classe.replace(/"/g, '""')}",${score.temps},"${new Date(score.date).toLocaleString()}"`
                ).join('\n');
                
                const csvContent = csvHeader + csvRows;
                const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8' });
                const url = URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = `classement_escape_${new Date().toISOString().split('T')[0]}.csv`;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                alert(`ðŸ“Š Classement exportÃ© : ${classementData.length} scores`);
            };
            
            const calculerStatistiques = () => {
                const classementData = getClassement();
                if (classementData.length === 0) return null;
                
                const parClasse = {};
                classementData.forEach(score => {
                    parClasse[score.classe] = (parClasse[score.classe] || 0) + 1;
                });
                
                return {
                    total: classementData.length,
                    meilleurTemps: classementData[0]?.temps || '--:--',
                    moyenneTemps: formatTemps(Math.floor(classementData.reduce((acc, s) => acc + s.tempsSecondes, 0) / classementData.length)),
                    parClasse: parClasse
                };
            };
            
            const resetTournoi = () => {
                if (window.confirm('ÃŠtes-vous sÃ»r de vouloir rÃ©initialiser tout le classement ? Cette action est irrÃ©versible.')) {
                    localStorage.removeItem('escapeGameTournoi');
                    localStorage.removeItem('codePartageTournoi');
                    setClassement([]);
                    alert('âœ… Classement rÃ©initialisÃ© !');
                }
            };
            
            const verifierLockout = () => {
                const lastAttempt = localStorage.getItem('lastAttempt_' + tournoiNom);
                if (lastAttempt) {
                    const diff = Date.now() - parseInt(lastAttempt);
                    if (diff < 3600000) {
                        setLockoutTime(3600000 - diff);
                        return true;
                    }
                }
                return false;
            };
            
            // ==================== FONCTIONS DU JEU ====================
            
            const tirerEnigmes = (theme) => {
                const banque = [...banqueEnigmes[theme]];
                return banque.sort(() => Math.random() - 0.5).slice(0, 4);
            };
            
            const genererCode = (index) => {
                const prefixes = ['EVO', 'CYB', 'DUR', 'UX', 'CRY'];
                return prefixes[index] + Math.floor(1000 + Math.random() * 9000);
            };
            
            useEffect(() => {
                if (ecran === 'room' && temps > 0) {
                    const timer = setInterval(() => {
                        setTemps(t => t - 1);
                        setTempsTotal(tt => tt + 1);
                    }, 1000);
                    return () => clearInterval(timer);
                }
            }, [ecran, temps]);
            
            // Charger le classement au dÃ©marrage
            useEffect(() => {
                setClassement(getClassement());
            }, []);
            
            const formatTemps = (s) => {
                const mins = Math.floor(s / 60);
                const secs = s % 60;
                return mins.toString().padStart(2, '0') + ':' + secs.toString().padStart(2, '0');
            };
            
            const resetGame = () => {
                if (verifierLockout() && ecran === 'victoire') {
                    return;
                }
                setEcran('accueil');
                setRoomActuelle(0);
                setCodesRooms([]);
                setTempsTotal(0);
                setChiffrementSelectionne(null);
                setTournoiNom('');
                setTournoiClasse('');
                setScoreEnregistre(false);
                setMessageDecrypte('');
            };
            
            const demarrerJeu = () => {
                if (verifierLockout()) {
                    return;
                }
                setCodesRooms([0, 1, 2, 3, 4].map(i => genererCode(i)));
                demarrerRoom(0);
            };
            
            const demarrerRoom = (index) => {
                if (index === 4) {
                    setRoomActuelle(index);
                    setTemps(TEMPS_PAR_ROOM);
                    setEcran('room5Crypto');
                } else {
                    setEnigmesSelectionnees(tirerEnigmes(roomsConfig[index].theme));
                    setRoomActuelle(index);
                    setEnigmeActuelle(0);
                    setEnigmesResolues([false, false, false, false]);
                    setTemps(TEMPS_PAR_ROOM);
                    setReponse('');
                    setErreur(false);
                    setIndiceAffiche(false);
                    setEcran('room');
                }
            };
            
            const verifierReponse = () => {
                const enigme = enigmesSelectionnees[enigmeActuelle];
                if (reponse.toLowerCase().trim() === enigme.reponse.toLowerCase()) {
                    const newResolues = [...enigmesResolues];
                    newResolues[enigmeActuelle] = true;
                    setEnigmesResolues(newResolues);
                    setErreur(false);
                    if (newResolues.every(r => r)) {
                        setTimeout(() => setEcran('codeRoom'), 1000);
                    } else {
                        setTimeout(() => {
                            setEnigmeActuelle(enigmeActuelle + 1);
                            setReponse('');
                            setIndiceAffiche(false);
                        }, 1000);
                    }
                } else {
                    setErreur(true);
                }
            };
            
            const verifierCodeEntree = () => {
                if (codeEntree.toUpperCase() === codesRooms[roomActuelle]) {
                    setCodeEntree('');
                    setErreurCode(false);
                    roomActuelle < 4 ? demarrerRoom(roomActuelle + 1) : setEcran('messageFinal');
                } else {
                    setErreurCode(true);
                }
            };
            
            const essayerSysteme = (systemeId) => {
                const systeme = systemesCodeage.find(s => s.id === systemeId);
                if (systeme.correct) {
                    setEcran('messageFinal');
                } else {
                    alert("âŒ Ce n'est pas le bon systÃ¨me de codage ! Essayez-en un autre.");
                }
            };
            
            const decrypterMessage = () => {
                if (messageDecrypte.toLowerCase().trim() === "bravo vous avez maitrise la technologie") {
                    setEcran('victoire');
                } else {
                    alert("Ce n'est pas la bonne rÃ©ponse. RÃ©essayez !");
                }
            };
            
            // ==================== RENDU DES Ã‰CRANS ====================
            
            if (ecran === 'accueil') {
                const stats = calculerStatistiques();
                const top5 = classement.slice(0, 5);
                
                return React.createElement('div', {
                    className: "min-h-screen bg-gradient-to-br from-indigo-900 via-purple-900 to-black p-4 flex items-center justify-center"
                },
                    React.createElement('div', {
                        className: "max-w-6xl w-full glass-panel rounded-3xl p-8 border border-purple-500/40"
                    },
                        // Bouton Admin
                        React.createElement('div', { className: "text-right mb-6" },
                            React.createElement('button', {
                                onClick: () => setModeAdmin(!modeAdmin),
                                className: "px-4 py-2 bg-gray-800 hover:bg-gray-700 rounded-lg transition-colors font-bold"
                            }, modeAdmin ? 'ðŸ‘¨â€ðŸ« Mode Normal' : 'ðŸ”§ Mode Admin')
                        ),
                        
                        // Titre
                        React.createElement('h1', {
                            className: "text-5xl md:text-6xl font-bold text-center mb-6 text-gradient font-orbitron"
                        }, 'ðŸŽ¯ Escape Game Technologie'),
                        
                        React.createElement('p', {
                            className: "text-xl text-center text-gray-300 mb-8"
                        }, '4 rooms thÃ©matiques + 1 dÃ©fi de dÃ©cryptage final !'),
                        
                        // Rooms
                        React.createElement('div', {
                            className: "grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4 my-8"
                        },
                            roomsConfig.map((room, i) => 
                                React.createElement('div', {
                                    key: i,
                                    className: `bg-gradient-to-r ${room.couleur} to-black p-4 rounded-xl border border-white/20 hover:scale-105 transition-all text-center`
                                },
                                    React.createElement('div', { className: "text-4xl mb-2" }, room.icone),
                                    React.createElement('div', { className: "text-white font-bold text-sm" }, room.nom)
                                )
                            )
                        ),
                        
                        // Statistiques tournoi
                        stats && React.createElement('div', {
                            className: "bg-purple-900/40 p-6 rounded-xl border border-purple-500/30 mb-6"
                        },
                            React.createElement('div', { className: "flex items-center gap-3 mb-4" },
                                React.createElement(Icon, { name: 'trophy', className: "text-yellow-400" }),
                                React.createElement('h3', { className: "text-2xl font-bold text-purple-300" }, 'ðŸ† Classement Tournoi')
                            ),
                            React.createElement('div', { className: "grid grid-cols-3 gap-4 text-center" },
                                React.createElement('div', null,
                                    React.createElement('p', { className: "text-sm text-gray-400" }, 'Participants'),
                                    React.createElement('p', { className: "text-2xl font-bold" }, stats.total)
                                ),
                                React.createElement('div', null,
                                    React.createElement('p', { className: "text-sm text-gray-400" }, 'Meilleur temps'),
                                    React.createElement('p', { className: "text-2xl font-bold text-green-400" }, stats.meilleurTemps)
                                ),
                                React.createElement('div', null,
                                    React.createElement('p', { className: "text-sm text-gray-400" }, 'Moyenne'),
                                    React.createElement('p', { className: "text-2xl font-bold" }, stats.moyenneTemps)
                                )
                            )
                        ),
                        
                        // Mode Admin
                        modeAdmin && React.createElement('div', {
                            className: "bg-red-900/30 p-6 rounded-xl border border-red-500/30 mb-6"
                        },
                            React.createElement('h3', { className: "text-2xl font-bold text-red-300 mb-4" }, 'ðŸ‘¨â€ðŸ« PANEL ADMIN'),
                            React.createElement('div', { className: "space-y-4" },
                                React.createElement('div', null,
                                    React.createElement('label', { className: "block text-sm mb-2" }, 'Code de partage Ã  importer :'),
                                    React.createElement('div', { className: "flex gap-2" },
                                        React.createElement('input', {
                                            type: "text",
                                            value: importCode,
                                            onChange: (e) => setImportCode(e.target.value),
                                            placeholder: "Collez le code ici...",
                                            className: "flex-1 p-3 bg-gray-800 rounded-lg border border-gray-700"
                                        }),
                                        React.createElement('button', {
                                            onClick: importerClassement,
                                            className: "px-4 py-3 bg-green-600 hover:bg-green-500 rounded-lg font-bold"
                                        }, 'ðŸ“¥ Importer')
                                    )
                                ),
                                React.createElement('div', { className: "grid grid-cols-2 gap-4" },
                                    React.createElement('button', {
                                        onClick: exporterCSV,
                                        className: "p-3 bg-blue-600 hover:bg-blue-500 rounded-lg flex items-center justify-center gap-2"
                                    },
                                        React.createElement(Icon, { name: 'download' }),
                                        'Exporter CSV'
                                    ),
                                    React.createElement('button', {
                                        onClick: resetTournoi,
                                        className: "p-3 bg-red-600 hover:bg-red-500 rounded-lg"
                                    }, 'â™»ï¸ RÃ©initialiser')
                                )
                            )
                        ),
                        
                        // RÃ¨gles
                        React.createElement('div', {
                            className: "bg-purple-900/40 p-6 rounded-xl border border-purple-500/30 mb-8"
                        },
                            React.createElement('h3', { className: "font-bold text-2xl mb-3 text-purple-300" }, 'ðŸ“‹ RÃ¨gles :'),
                            React.createElement('ul', { className: "list-disc list-inside space-y-2 text-lg text-gray-300" },
                                React.createElement('li', null, '4 rooms : 4 Ã©nigmes en 10 min'),
                                React.createElement('li', null, 'Room 5 : Choisir le bon systÃ¨me de codage'),
                                React.createElement('li', null, 'DÃ©crypter le message final !'),
                                React.createElement('li', { className: "text-yellow-400 font-bold" }, 'ðŸ† Participation au tournoi automatique')
                            )
                        ),
                        
                        // Bouton dÃ©marrer
                        React.createElement('button', {
                            onClick: demarrerJeu,
                            className: "w-full bg-gradient-to-r from-purple-600 via-pink-600 to-red-600 hover:from-purple-500 hover:via-pink-500 hover:to-red-500 text-white font-bold py-5 px-8 rounded-xl text-2xl transition-all hover:scale-105 mb-8"
                        }, 'ðŸš€ Commencer le jeu'),
                        
                        // Top 5
                        top5.length > 0 && React.createElement('div', null,
                            React.createElement('h3', { className: "text-2xl font-bold text-center mb-4 text-yellow-300" }, 'ðŸ† TOP 5'),
                            React.createElement('div', { className: "space-y-2 mb-4" },
                                top5.map((score, index) => 
                                    React.createElement('div', {
                                        key: score.id,
                                        className: `flex justify-between items-center p-3 rounded-lg ${
                                            index === 0 ? 'bg-yellow-900/40' :
                                            index === 1 ? 'bg-gray-800/60' :
                                            index === 2 ? 'bg-orange-900/40' :
                                            'bg-slate-800/30'
                                        }`
                                    },
                                        React.createElement('div', { className: "flex items-center" },
                                            React.createElement('span', {
                                                className: `w-8 h-8 flex items-center justify-center rounded-full mr-3 ${
                                                    index === 0 ? 'bg-yellow-500 text-black font-bold' :
                                                    index === 1 ? 'bg-gray-400 text-black' :
                                                    index === 2 ? 'bg-orange-600' :
                                                    'bg-slate-700'
                                                }`
                                            }, index === 0 ? 'ðŸ‘‘' : index + 1),
                                            React.createElement('div', null,
                                                React.createElement('p', { className: "font-bold" }, score.nom),
                                                React.createElement('p', { className: "text-sm text-gray-400" }, score.classe)
                                            )
                                        ),
                                        React.createElement('div', { className: "font-mono font-bold" }, score.temps)
                                    )
                                )
                            ),
                            React.createElement('p', { className: "text-center text-sm text-gray-500" },
                                `${classement.length} participants au total`
                            )
                        )
                    )
                );
            }
            
            if (ecran === 'room5Crypto') {
                return React.createElement('div', {
                    className: "min-h-screen bg-gradient-to-br from-amber-900 via-yellow-900 to-black p-4"
                },
                    React.createElement('div', { className: "max-w-6xl mx-auto" },
                        React.createElement('div', {
                            className: "glass-panel rounded-3xl p-8 border border-yellow-500/40"
                        },
                            React.createElement('div', { className: "text-center mb-8" },
                                React.createElement('div', { className: "text-6xl mb-4" }, 'ðŸ”‘'),
                                React.createElement('h1', {
                                    className: "text-5xl font-bold mb-4 text-gradient font-orbitron"
                                }, 'Room 5 : SystÃ¨mes de Codage'),
                                React.createElement('p', { className: "text-xl text-gray-300" }, 'Choisissez le bon systÃ¨me pour dÃ©crypter le message !')
                            ),
                            React.createElement('div', { className: "grid grid-cols-1 md:grid-cols-2 gap-6 mb-8" },
                                systemesCodeage.map((sys) => 
                                    React.createElement('div', {
                                        key: sys.id,
                                        onClick: () => setChiffrementSelectionne(sys.id === chiffrementSelectionne ? null : sys.id),
                                        className: `cursor-pointer bg-gradient-to-br from-yellow-900/40 to-orange-900/40 p-6 rounded-2xl border-2 transition-all hover:scale-105 ${
                                            chiffrementSelectionne === sys.id ? 'border-yellow-400 shadow-lg' : 'border-gray-500'
                                        }`
                                    },
                                        React.createElement('h3', { className: "text-2xl font-bold text-yellow-300 mb-3" }, sys.nom),
                                        React.createElement('p', { className: "text-gray-300 mb-4" }, sys.description),
                                        React.createElement('div', { className: "bg-black/40 p-4 rounded-lg mb-4" },
                                            React.createElement('p', { className: "text-yellow-200 font-mono" }, sys.exemple)
                                        ),
                                        chiffrementSelectionne === sys.id && React.createElement('button', {
                                            onClick: (e) => { e.stopPropagation(); essayerSysteme(sys.id); },
                                            className: "w-full bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-500 hover:to-emerald-500 text-white font-bold py-3 px-6 rounded-lg mt-4"
                                        }, 'âœ“ Utiliser ce systÃ¨me')
                                    )
                                )
                            ),
                            React.createElement('div', {
                                className: "bg-orange-900/30 border-2 border-orange-400 rounded-xl p-6 text-center"
                            },
                                React.createElement('p', { className: "text-xl text-orange-300 font-bold" }, 'ðŸ’¡ Conseil :'),
                                React.createElement('p', { className: "text-gray-300 mt-2" }, 'Cliquez sur chaque systÃ¨me pour le dÃ©couvrir, puis choisissez celui qui vous semble correct !')
                            )
                        )
                    )
                );
            }
            
            if (ecran === 'codeRoom') {
                const room = roomsConfig[roomActuelle];
                return React.createElement('div', {
                    className: `min-h-screen bg-gradient-to-br ${room.couleur} to-black flex items-center justify-center p-4`
                },
                    React.createElement('div', {
                        className: "max-w-2xl w-full glass-panel rounded-3xl p-8 border border-white/30 text-center"
                    },
                        React.createElement('div', { className: "text-7xl mb-6" }, room.icone),
                        React.createElement('h2', { className: "text-4xl font-bold mb-6 text-white" }, `Room ${roomActuelle + 1} TerminÃ©e !`),
                        React.createElement('div', {
                            className: "bg-green-900/40 border-2 border-green-400 rounded-2xl p-8 mb-8"
                        },
                            React.createElement(Icon, { name: 'key', className: "mx-auto text-yellow-400 mb-4", size: 64 }),
                            React.createElement('p', { className: "text-2xl text-gray-300 mb-4" }, 'Code d\'accÃ¨s :'),
                            React.createElement('p', { className: "text-6xl font-bold text-yellow-400 tracking-widest font-mono" }, codesRooms[roomActuelle])
                        ),
                        roomActuelle < 4 ? React.createElement('div', null,
                            React.createElement('p', { className: "text-xl text-gray-300 mb-6" }, 'Entrez ce code :'),
                            React.createElement('input', {
                                type: "text",
                                value: codeEntree,
                                onChange: (e) => setCodeEntree(e.target.value),
                                onKeyPress: (e) => e.key === 'Enter' && verifierCodeEntree(),
                                placeholder: "CODE...",
                                className: "w-full bg-gray-800 border-2 border-purple-500/50 rounded-xl px-6 py-4 text-white text-2xl text-center font-bold uppercase focus:outline-none mb-4"
                            }),
                            erreurCode && React.createElement('div', {
                                className: "flex items-center justify-center gap-2 text-red-400 mb-4"
                            },
                                React.createElement(Icon, { name: 'x' }),
                                React.createElement('span', null, 'Code incorrect !')
                            ),
                            React.createElement('button', {
                                onClick: verifierCodeEntree,
                                className: "w-full bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-500 hover:to-emerald-500 text-white font-bold py-4 px-8 rounded-xl text-xl"
                            }, 'Valider')
                        ) : React.createElement('button', {
                            onClick: () => setEcran('messageFinal'),
                            className: "w-full bg-gradient-to-r from-yellow-600 to-orange-600 hover:from-yellow-500 hover:to-orange-500 text-white font-bold py-4 px-8 rounded-xl text-xl"
                        }, 'DÃ©fi Final â†’')
                    )
                );
            }
            
            if (ecran === 'messageFinal') {
                return React.createElement('div', {
                    className: "min-h-screen bg-gradient-to-br from-yellow-900 via-orange-900 to-black flex items-center justify-center p-4"
                },
                    React.createElement('div', {
                        className: "max-w-3xl w-full glass-panel rounded-3xl p-8 border border-yellow-500/40"
                    },
                        React.createElement('div', { className: "text-center mb-8" },
                            React.createElement('div', { className: "text-6xl mb-4" }, 'ðŸ”“'),
                            React.createElement('h2', {
                                className: "text-5xl font-bold mb-6 text-gradient font-orbitron"
                            }, 'DÃ©fi Final'),
                            React.createElement('p', { className: "text-xl text-green-400 font-bold" }, 'âœ… Bon systÃ¨me choisi ! Maintenant dÃ©cryptez :')
                        ),
                        React.createElement('div', {
                            className: "bg-orange-900/40 border-2 border-orange-400 rounded-2xl p-6 mb-8"
                        },
                            React.createElement('h3', { className: "text-2xl font-bold text-orange-300 mb-4" }, 'ðŸ” Message CryptÃ© :'),
                            React.createElement('div', { className: "bg-black/60 p-6 rounded-lg" },
                                React.createElement('p', { className: "text-4xl font-mono text-white text-center" }, 'Csbwp wpvt bwfa nbjusjuf mb ufdiopophjf')
                            )
                        ),
                        React.createElement('div', {
                            className: "bg-yellow-900/30 border-2 border-yellow-500/50 rounded-xl p-6 mb-8"
                        },
                            React.createElement('h3', { className: "text-2xl font-bold text-yellow-300 mb-3" }, 'ðŸ’¡ MÃ©thode CÃ©sar :'),
                            React.createElement('p', { className: "text-gray-300 text-lg mb-3" },
                                'DÃ©calage de ',
                                React.createElement('span', { className: "text-yellow-400 font-bold" }, '1 lettre vers la GAUCHE')
                            ),
                            React.createElement('div', { className: "bg-black/40 p-4 rounded-lg" },
                                React.createElement('p', { className: "text-center text-yellow-200 font-mono" }, 'B â†’ A, C â†’ B, D â†’ C...')
                            )
                        ),
                        React.createElement('input', {
                            type: "text",
                            value: messageDecrypte,
                            onChange: (e) => setMessageDecrypte(e.target.value),
                            onKeyPress: (e) => e.key === 'Enter' && decrypterMessage(),
                            placeholder: "Message dÃ©cryptÃ©...",
                            className: "w-full bg-gray-800 border-2 border-yellow-500/50 rounded-xl px-6 py-4 text-white text-xl focus:outline-none mb-6"
                        }),
                        React.createElement('button', {
                            onClick: decrypterMessage,
                            className: "w-full bg-gradient-to-r from-yellow-600 to-orange-600 hover:from-yellow-500 hover:to-orange-500 text-white font-bold py-5 px-8 rounded-xl text-2xl"
                        }, 'DÃ©crypter')
                    )
                );
            }
            
            if (ecran === 'victoire') {
                const position = classement.findIndex(s => s.temps === formatTemps(tempsTotal)) + 1;
                const estSurPodium = position <= 3;
                
                return React.createElement('div', {
                    className: "min-h-screen bg-gradient-to-br from-green-900 via-emerald-900 to-black p-4"
                },
                    React.createElement('div', { className: "max-w-6xl mx-auto" },
                        React.createElement('div', {
                            className: "glass-panel rounded-3xl p-8 border border-green-500/40"
                        },
                            // Animation victoire
                            React.createElement('div', { className: "text-center mb-8" },
                                React.createElement('div', {
                                    className: "text-9xl mb-6 animate-float"
                                }, 'ðŸŽ‰'),
                                React.createElement('h1', {
                                    className: "text-7xl font-bold mb-6 text-gradient font-orbitron"
                                }, 'VICTOIRE !'),
                                React.createElement('div', {
                                    className: "text-4xl text-white mb-8 font-bold"
                                }, 'Bravo vous avez maÃ®trisÃ© la technologie')
                            ),
                            
                            // Grid Temps + Tournoi
                            React.createElement('div', {
                                className: "grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8"
                            },
                                // Temps
                                React.createElement('div', {
                                    className: "bg-green-900/40 border-2 border-green-400 rounded-2xl p-8"
                                },
                                    React.createElement(Icon, { name: 'trophy', className: "mx-auto text-yellow-400 mb-4", size: 80 }),
                                    React.createElement('p', { className: "text-3xl text-gray-300 mb-3 text-center" }, 'Votre temps :'),
                                    React.createElement('p', {
                                        className: "text-6xl font-bold text-yellow-400 text-center font-mono"
                                    }, formatTemps(tempsTotal))
                                ),
                                
                                // Formulaire Tournoi
                                React.createElement('div', {
                                    className: "bg-purple-900/40 border-2 border-purple-400 rounded-2xl p-8"
                                },
                                    React.createElement('h3', {
                                        className: "text-3xl font-bold text-purple-300 mb-6 text-center"
                                    }, 'ðŸ† PARTICIPER AU TOURNOI'),
                                    
                                    !scoreEnregistre ? React.createElement('div', { className: "space-y-6" },
                                        React.createElement('div', null,
                                            React.createElement('label', {
                                                className: "block text-lg mb-2"
                                            }, 'Votre nom'),
                                            React.createElement('input', {
                                                type: "text",
                                                value: tournoiNom,
                                                onChange: (e) => setTournoiNom(e.target.value),
                                                placeholder: "Nom PrÃ©nom",
                                                className: "w-full p-4 bg-gray-800 rounded-xl text-xl border border-gray-700 focus:border-purple-500 focus:outline-none"
                                            })
                                        ),
                                        React.createElement('div', null,
                                            React.createElement('label', {
                                                className: "block text-lg mb-2"
                                            }, 'Votre classe'),
                                            React.createElement('input', {
                                                type: "text",
                                                value: tournoiClasse,
                                                onChange: (e) => setTournoiClasse(e.target.value),
                                                placeholder: "Ex: 3A",
                                                className: "w-full p-4 bg-gray-800 rounded-xl text-xl border border-gray-700 focus:border-purple-500 focus:outline-none"
                                            })
                                        ),
                                        React.createElement('button', {
                                            onClick: sauvegarderScore,
                                            className: "w-full bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-500 hover:to-emerald-500 text-white font-bold py-4 rounded-xl text-2xl transition-all"
                                        }, 'âœ… Enregistrer mon score')
                                    ) : React.createElement('div', { className: "text-center p-6" },
                                        React.createElement('div', { className: "text-6xl mb-4" }, 'ðŸ¥³'),
                                        React.createElement('h4', { className: "text-3xl font-bold mb-4" }, 'Score enregistrÃ© !'),
                                        estSurPodium ? React.createElement('div', {
                                            className: "bg-yellow-900/40 p-6 rounded-xl mb-6"
                                        },
                                            React.createElement('p', { className: "text-2xl text-yellow-300 font-bold mb-2" }, 
                                                position === 1 ? 'ðŸ¥‡ CHAMPION !' :
                                                position === 2 ? 'ðŸ¥ˆ DEUXIÃˆME !' : 'ðŸ¥‰ TROISIÃˆME !'
                                            ),
                                            React.createElement('p', { className: "text-xl" }, `Position ${position} sur ${classement.length}`)
                                        ) : React.createElement('p', { className: "text-xl mb-6" },
                                            `Position ${position} sur ${classement.length} participants`
                                        ),
                                        React.createElement('div', { className: "space-y-4" },
                                            React.createElement('button', {
                                                onClick: exporterCSV,
                                                className: "w-full p-4 bg-blue-600 hover:bg-blue-500 rounded-lg flex items-center justify-center gap-3 text-lg"
                                            },
                                                React.createElement(Icon, { name: 'download' }),
                                                'TÃ©lÃ©charger le classement'
                                            ),
                                            React.createElement('button', {
                                                onClick: () => {
                                                    const code = genererCodePartage();
                                                    navigator.clipboard.writeText(code).then(() => {
                                                        alert(`Code copiÃ© dans le presse-papier :\n\n${code}\n\nPartagez-le avec les autres postes !`);
                                                    });
                                                },
                                                className: "w-full p-4 bg-purple-600 hover:bg-purple-500 rounded-lg flex items-center justify-center gap-3 text-lg"
                                            },
                                                React.createElement(Icon, { name: 'share' }),
                                                'Copier code de partage'
                                            )
                                        )
                                    )
                                )
                            ),
                            
                            // Classement en direct
                            classement.length > 0 && React.createElement('div', {
                                className: "bg-slate-900/60 rounded-2xl p-6 mb-8"
                            },
                                React.createElement('h3', {
                                    className: "text-3xl font-bold text-center mb-6 text-yellow-300"
                                }, 'ðŸ† CLASSEMENT EN DIRECT'),
                                React.createElement('div', {
                                    className: "space-y-3 max-h-80 overflow-y-auto scrollbar-thin"
                                },
                                    classement.slice(0, 10).map((score, index) => 
                                        React.createElement('div', {
                                            key: score.id,
                                            className: `flex justify-between items-center p-4 rounded-xl ${
                                                score.temps === formatTemps(tempsTotal) ? 'bg-green-900/40 border-2 border-green-400' :
                                                index === 0 ? 'bg-yellow-900/40' :
                                                index === 1 ? 'bg-gray-800/60' :
                                                index === 2 ? 'bg-orange-900/40' :
                                                'bg-slate-800/30'
                                            }`
                                        },
                                            React.createElement('div', { className: "flex items-center" },
                                                React.createElement('span', {
                                                    className: `w-10 h-10 flex items-center justify-center rounded-full mr-4 ${
                                                        score.temps === formatTemps(tempsTotal) ? 'bg-green-500 text-black font-bold' :
                                                        index === 0 ? 'bg-yellow-500 text-black font-bold' :
                                                        index === 1 ? 'bg-gray-400 text-black' :
                                                        index === 2 ? 'bg-orange-600' :
                                                        'bg-slate-700'
                                                    }`
                                                },
                                                    score.temps === formatTemps(tempsTotal) ? 'VOUS' :
                                                    index === 0 ? 'ðŸ‘‘' : index + 1
                                                ),
                                                React.createElement('div', null,
                                                    React.createElement('p', { className: "font-bold text-xl" }, score.nom),
                                                    React.createElement('p', { className: "text-gray-400" }, score.classe)
                                                )
                                            ),
                                            React.createElement('div', {
                                                className: "font-mono font-bold text-2xl"
                                            }, score.temps)
                                        )
                                    )
                                )
                            ),
                            
                            // Boutons d'action
                            React.createElement('div', { className: "text-center space-y-6" },
                                React.createElement('button', {
                                    onClick: resetGame,
                                    className: "bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-500 hover:to-pink-500 text-white font-bold py-5 px-10 rounded-xl text-2xl w-full max-w-md mx-auto block transition-all hover:scale-105"
                                }, 'ðŸ”„ Rejouer'),
                                
                                lockoutTime ? React.createElement('div', {
                                    className: "bg-yellow-900/40 p-4 rounded-xl max-w-md mx-auto"
                                },
                                    React.createElement('p', { className: "text-yellow-400 text-lg font-bold" }, 'â±ï¸ Verrouillage anti-triche'),
                                    React.createElement('p', { className: "text-gray-300" },
                                        `Prochaine tentative dans ${Math.ceil(lockoutTime / 60000)} minutes`
                                    )
                                ) : null,
                                
                                React.createElement('div', { className: "text-gray-400 text-sm mt-4" },
                                    React.createElement('p', null, 'ðŸ’¡ Le classement est stockÃ© localement sur cet ordinateur.'),
                                    React.createElement('p', null, 'Utilisez le code de partage pour synchroniser entre postes !')
                                )
                            )
                        )
                    )
                );
            }
            
            // Ã‰cran Room standard
            const room = roomsConfig[roomActuelle];
            const enigme = enigmesSelectionnees[enigmeActuelle];
            const progression = (enigmesResolues.filter(Boolean).length / 4) * 100;
            
            return React.createElement('div', {
                className: `min-h-screen bg-gradient-to-br ${room.couleur} to-black p-4`
            },
                // En-tÃªte
                React.createElement('div', { className: "max-w-4xl mx-auto mb-6" },
                    React.createElement('div', {
                        className: "glass-panel rounded-2xl p-5 border border-white/30"
                    },
                        React.createElement('div', { className: "flex justify-between items-center mb-4" },
                            React.createElement('div', { className: "flex items-center gap-4" },
                                React.createElement('div', { className: "text-4xl" }, room.icone),
                                React.createElement('div', null,
                                    React.createElement('div', {
                                        className: "text-white font-bold text-2xl"
                                    }, `Room ${roomActuelle + 1}: ${room.nom}`),
                                    React.createElement('div', { className: "text-gray-300" }, `Ã‰nigme ${enigmeActuelle + 1} / 4`)
                                )
                            ),
                            React.createElement('div', { className: "flex items-center gap-3" },
                                React.createElement(Icon, {
                                    name: 'clock',
                                    className: temps < 60 ? "text-red-400" : "text-yellow-400"
                                }),
                                React.createElement('span', {
                                    className: `text-4xl font-bold font-mono ${
                                        temps < 60 ? 'text-red-400' : 'text-yellow-400'
                                    }`
                                }, formatTemps(temps))
                            )
                        ),
                        React.createElement('div', { className: "w-full bg-gray-700 rounded-full h-5" },
                            React.createElement('div', {
                                className: "bg-gradient-to-r from-green-500 to-emerald-500 h-5 rounded-full transition-all duration-500",
                                style: { width: `${progression}%` }
                            })
                        )
                    )
                ),
                
                // Ã‰nigme
                React.createElement('div', { className: "max-w-4xl mx-auto" },
                    React.createElement('div', {
                        className: "glass-panel rounded-3xl p-8 border border-white/30"
                    },
                        React.createElement('div', { className: "flex items-center gap-4 mb-6" },
                            React.createElement(Icon, { name: 'lock', className: "text-white" }),
                            React.createElement('h2', {
                                className: "text-4xl font-bold text-white"
                            }, `Ã‰nigme ${enigmeActuelle + 1}`)
                        ),
                        React.createElement('div', {
                            className: "bg-white/10 p-8 rounded-2xl border border-white/20 mb-6"
                        },
                            React.createElement('p', { className: "text-2xl text-white" }, enigme.question)
                        ),
                        
                        indiceAffiche && React.createElement('div', {
                            className: "bg-yellow-900/40 border-2 border-yellow-500/50 p-5 rounded-lg mb-6 flex items-start gap-3"
                        },
                            React.createElement(Icon, { name: 'lightbulb', className: "text-yellow-400 flex-shrink-0 mt-1" }),
                            React.createElement('p', { className: "text-yellow-200 text-xl" }, `ðŸ’¡ ${enigme.indice}`)
                        ),
                        
                        React.createElement('div', { className: "space-y-5" },
                            React.createElement('input', {
                                type: enigme.type,
                                value: reponse,
                                onChange: (e) => setReponse(e.target.value),
                                onKeyPress: (e) => e.key === 'Enter' && verifierReponse(),
                                disabled: enigmesResolues[enigmeActuelle],
                                placeholder: "Votre rÃ©ponse...",
                                className: "w-full bg-gray-800 border-2 border-white/30 rounded-xl px-6 py-5 text-white text-2xl focus:outline-none focus:border-blue-500 disabled:opacity-50"
                            }),
                            
                            erreur && React.createElement('div', {
                                className: "flex items-center gap-3 text-red-400 text-xl"
                            },
                                React.createElement(Icon, { name: 'x' }),
                                React.createElement('span', null, 'âŒ Incorrect !')
                            ),
                            
                            enigmesResolues[enigmeActuelle] && React.createElement('div', {
                                className: "flex items-center gap-3 text-green-400 text-xl"
                            },
                                React.createElement(Icon, { name: 'check' }),
                                React.createElement('span', null, 'âœ… RÃ©solue !')
                            ),
                            
                            React.createElement('div', { className: "flex gap-4" },
                                React.createElement('button', {
                                    onClick: verifierReponse,
                                    disabled: enigmesResolues[enigmeActuelle] || !reponse,
                                    className: "flex-1 bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-500 hover:to-emerald-500 disabled:from-gray-600 disabled:to-gray-600 text-white font-bold py-5 px-6 rounded-xl text-xl disabled:cursor-not-allowed transition-all"
                                }, 'Valider'),
                                
                                !indiceAffiche && !enigmesResolues[enigmeActuelle] && React.createElement('button', {
                                    onClick: () => setIndiceAffiche(true),
                                    className: "bg-yellow-600 hover:bg-yellow-500 text-white font-bold py-5 px-8 rounded-xl flex items-center gap-3 transition-all"
                                },
                                    React.createElement(Icon, { name: 'lightbulb' }),
                                    'Indice'
                                )
                            )
                        )
                    )
                )
            );
        }
        
        // ==================== RENDU DE L'APPLICATION ====================
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(React.createElement(EscapeGame));
    </script>
    
    <script>
        // Polyfill pour les navigateurs plus anciens
        if (!window.btoa) {
            window.btoa = function(str) {
                return Buffer.from(str).toString('base64');
            };
        }
        
        if (!window.atob) {
            window.atob = function(b64) {
                return Buffer.from(b64, 'base64').toString();
            };
        }
        
        // DÃ©tection du support
        if (typeof React === 'undefined') {
            document.getElementById('root').innerHTML = `
                <div class="min-h-screen flex items-center justify-center p-4">
                    <div class="bg-red-900/50 p-8 rounded-xl text-center max-w-md">
                        <h1 class="text-3xl text-red-400 mb-4">âš ï¸ Erreur de chargement</h1>
                        <p class="text-gray-300 mb-4">Votre navigateur ne supporte pas certaines fonctionnalitÃ©s nÃ©cessaires.</p>
                        <p class="text-sm text-gray-400">Essayez avec Chrome, Firefox ou Edge rÃ©cent.</p>
                    </div>
                </div>
            `;
        }
    </script>
</body>
</html>
